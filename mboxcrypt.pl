perl -e 'while (<>) { $suffix=""; if (/^(From )([^@]*@[^ ]*)( .*)$/) { $hdr=1; $prefix=$1; $value=$2; $suffix=$3; } elsif ($hdr) { if (/^([\t ]+)(.*)$/) { $prefix=$1; $value=$2; } elsif (/^([^:]*)(:.*)$/) { $prefix=$1; $value=$2; if ($prefix =~ /^(X-UID|X-IMAP|X-Keywords|X-Status|Status|Content|Date)/) { $prefix .= $value; $value=""; } } else { $prefix=""; $value=""; $hdr = 0; } } else { $prefix=""; $value=$_; }; $value =~ s/\w/x/g; print "$prefix$value$suffix\n"; }' 
